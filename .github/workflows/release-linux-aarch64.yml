name: release-linux-aarch64

on:
  push:
    branches: [ "master" ]
    tags:
      - '*'

jobs:
  build:

    runs-on: ubuntu-20.04
    # strategy:
    #   fail-fast: false
    #   matrix:
    #     platform: 
    #       - linux/amd64
    #       - linux/arm64

    steps:

    - name: list aarch64 lib
      run: apt-cache search aarch64

    - name: install aarch64 lib
      run: sudo apt-get install gcc-aarch64-linux-gnu g++-aarch64-linux-gnu

    - name: find the aarch64 gcc
      run: whereis aarch64-linux-gnu-gcc

    - name: ls usr-bin
      run: ls /usr/bin |grep aarch64

    - name: write cmake file
      run: |
        echo "SET (CMAKE_SYSTEM_NAME Linux)
          SET (CMAKE_SYSTEM_PROCESSOR aarch64)
          SET (CMAKE_C_COMPILER /usr/bin/aarch64-linux-gnu-gcc)
          SET (CMAKE_CXX_COMPILER /usr/bin/aarch64-linux-gnu-g++)" > linux-aarch64.cmake
    - name: get new cmake
      run: cat linux-aarch64.cmake
